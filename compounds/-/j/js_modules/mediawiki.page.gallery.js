(function(){var $galleries,bound=!1,lastWidth=window.innerWidth,justifyNeeded=!1,isTouchScreen=!!(window.ontouchstart!==undefined||window.DocumentTouch!==undefined&&document instanceof window.DocumentTouch);function justify(){var lastTop,rows=[],$gallery=$(this);$gallery.children('li.gallerybox').each(function(){var $img,imgWidth,imgHeight,outerWidth,captionWidth,top=Math.floor($(this).position().top),$this=$(this);if(top!==lastTop){rows.push([]);lastTop=top;}$img=$this.find('div.thumb a.image img');if($img.length&&$img[0].height){imgHeight=$img[0].height;imgWidth=$img[0].width;}else{imgHeight=$this.children().children('div').first().height();imgWidth=$this.children().children('div').first().width();}if(imgHeight<30){imgHeight=0;}captionWidth=$this.children().children('div.gallerytextwrapper').width();outerWidth=$this.outerWidth();rows[rows.length-1].push({$elm:$this,width:outerWidth,imgWidth:imgWidth,aspect:imgWidth/imgHeight,captionWidth:captionWidth,height:imgHeight});$this.
data('imgWidth',imgWidth);$this.data('imgHeight',imgHeight);$this.data('width',outerWidth);$this.data('captionWidth',captionWidth);});(function(){var maxWidth,combinedAspect,combinedPadding,curRow,curRowHeight,wantedWidth,preferredHeight,newWidth,padding,$outerDiv,$innerDiv,$imageDiv,$imageElm,imageElm,$caption,i,j,avgZoom,totalZoom=0;for(i=0;i<rows.length;i++){maxWidth=$gallery.width();combinedAspect=0;combinedPadding=0;curRow=rows[i];curRowHeight=0;for(j=0;j<curRow.length;j++){if(curRowHeight===0){if(isFinite(curRow[j].height)){curRowHeight=curRow[j].height;}}if(curRow[j].aspect===0||!isFinite(curRow[j].aspect)){combinedPadding+=curRow[j].width;}else{combinedAspect+=curRow[j].aspect;combinedPadding+=curRow[j].width-curRow[j].imgWidth;}}combinedPadding+=5*curRow.length;wantedWidth=maxWidth-combinedPadding;preferredHeight=wantedWidth/combinedAspect;if(preferredHeight>curRowHeight*1.5){if(i===rows.length-1){avgZoom=(totalZoom/(rows.length-1))*curRowHeight;if(isFinite(avgZoom)&&avgZoom>=
1&&avgZoom<=1.5){preferredHeight=avgZoom;}else{preferredHeight=curRowHeight;}}else{preferredHeight=1.5*curRowHeight;}}if(!isFinite(preferredHeight)){continue;}if(preferredHeight<5){continue;}if(preferredHeight/curRowHeight>1){totalZoom+=preferredHeight/curRowHeight;}else{totalZoom+=1;}for(j=0;j<curRow.length;j++){newWidth=preferredHeight*curRow[j].aspect;padding=curRow[j].width-curRow[j].imgWidth;$outerDiv=curRow[j].$elm;$innerDiv=$outerDiv.children('div').first();$imageDiv=$innerDiv.children('div.thumb');$imageElm=$imageDiv.find('img').first();$caption=$outerDiv.find('div.gallerytextwrapper');$imageDiv.children('div').css('margin','0px auto');if(newWidth<60||!isFinite(newWidth)){if(newWidth<1||!isFinite(newWidth)){$innerDiv.height(preferredHeight);continue;}}else{$outerDiv.width(newWidth+padding);$innerDiv.width(newWidth+padding);$imageDiv.width(newWidth);$caption.width(curRow[j].captionWidth+(newWidth-curRow[j].imgWidth));}if($imageElm[0]){imageElm=$imageElm[0];imageElm.width=
newWidth;imageElm.height=preferredHeight;}else{$imageDiv.height(preferredHeight);}}}}());}function handleResizeStart(){if(lastWidth===window.innerWidth){return;}justifyNeeded=!0;$galleries.css('min-height',function(){return $(this).height();});$galleries.children('li.gallerybox').each(function(){var imgWidth=$(this).data('imgWidth'),imgHeight=$(this).data('imgHeight'),width=$(this).data('width'),captionWidth=$(this).data('captionWidth'),$innerDiv=$(this).children('div').first(),$imageDiv=$innerDiv.children('div.thumb'),$imageElm,imageElm;$(this).width(width);$innerDiv.width(width);$imageDiv.width(imgWidth);$(this).find('div.gallerytextwrapper').width(captionWidth);$imageElm=$(this).find('img').first();if($imageElm[0]){imageElm=$imageElm[0];imageElm.width=imgWidth;imageElm.height=imgHeight;}else{$imageDiv.height(imgHeight);}});}function handleResizeEnd(){if(justifyNeeded){justifyNeeded=!1;lastWidth=window.innerWidth;$galleries.css('min-height','').each(justify);}}mw.hook(
'wikipage.content').add(function($content){if(isTouchScreen){$content.find('ul.mw-gallery-packed-hover').addClass('mw-gallery-packed-overlay').removeClass('mw-gallery-packed-hover');}else{$content.find('ul.mw-gallery-packed-hover li.gallerybox').on('focus blur','a',function(e){var gettingFocus=e.type!=='blur'&&e.type!=='focusout';$(this).closest('li.gallerybox').toggleClass('mw-gallery-focused',gettingFocus);});}$galleries=$content.find('ul.mw-gallery-packed-overlay, ul.mw-gallery-packed-hover, ul.mw-gallery-packed');setTimeout(function(){$galleries.each(justify);if(!bound){bound=!0;$(window).on('resize',$.debounce(300,true,handleResizeStart)).on('resize',$.debounce(300,handleResizeEnd));}});});}());
mw.loader.state({"mediawiki.page.gallery":"ready"});